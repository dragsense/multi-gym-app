listen 1935;
max_connections 1000;
daemon off;
srs_log_tank console;

# RTC Server configuration (global level)
# Candidate IP will be set via CANDIDATE environment variable
# If not set, SRS will auto-detect from network interface
rtc_server {
    enabled         on;
    # Listen at udp://8000
    listen          8000;
    #
    # The $CANDIDATE means fetch from env, if not configed, use * as default.
    #
    # The * means retrieving server IP automatically, from all network interfaces,
    # @see https://github.com/ossrs/srs/issues/307#issuecomment-599028124
    candidate       $CANDIDATE;
    merge_nalus off;
}

# HTTP API for SRS (RTC API)
http_api {
    enabled on;
    listen 1985;
    crossdomain on;
}

# HTTP Server for FLV/HLS
http_server {
    enabled on;
    listen 8080;
    dir ./objs/nginx/html;
}

vhost __defaultVhost__ {
    # HTTP remux for FLV playback
    http_remux {
        enabled on;
        mount [vhost]/[app]/[stream].flv;
    }

    # HLS configuration
    hls {
        enabled on;
        hls_fragment 2;
        hls_window 6;
        hls_path ./objs/nginx/html;
        hls_m3u8_file [app]/[stream].m3u8;
        hls_ts_file [app]/[stream]-[seq].ts;
    }

    # RTC (WebRTC) configuration
    rtc {
        enabled on;
        rtmp_to_rtc on;
        nack on;
        twcc on;
        bframe discard;
        # Candidate IP for WebRTC - use * for auto-detection or specific IP
    }
}
